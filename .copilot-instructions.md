# GitHub Copilot Instructions for Auto-Rename Project

## Project Context
This is a Go application that renames files to UUID-based names with Docker containerization support.

## Copilot Behavioral Guidelines

### 1. File Operations
- **Priority**: Always implement file operations with proper error handling
- **Pattern**: Use `filepath.Join()` for cross-platform path handling
- **Safety**: Implement dry-run mode for preview operations
- **Validation**: Check file/directory existence before operations

### 2. UUID Generation
- **Library**: Use `github.com/google/uuid` package
- **Pattern**: Generate UUID v4 with `uuid.New().String()`
- **Preservation**: Always preserve original file extensions
- **Format**: `{uuid}.{original_extension}`

### 3. Command Line Interface
- **Library**: Use Go's standard `flag` package
- **Required**: `-dir` flag for target directory
- **Optional**: `-dry-run` flag for preview mode
- **Validation**: Validate all inputs before processing

### 4. Error Handling
- **Logging**: Use `log` package for errors
- **Context**: Wrap errors with context using `fmt.Errorf`
- **Recovery**: Continue processing other files if one fails
- **User Feedback**: Provide clear error messages

### 5. Docker Best Practices
- **Multi-stage**: Use multi-stage builds for smaller images
- **Base Image**: Use Alpine Linux for minimal footprint
- **Security**: Run as non-root user when possible
- **Volumes**: Design for external volume mounting

### 6. Go Code Conventions
- **Naming**: Use camelCase for functions, PascalCase for types
- **Structure**: Separate concerns into functions
- **Documentation**: Add comments for exported functions
- **Testing**: Write unit tests for core functionality

### 7. Dependency Management
- **Modules**: Use Go modules (`go.mod`)
- **Versions**: Pin dependency versions
- **Minimal**: Only include necessary dependencies

## Code Patterns to Follow

### File Processing Loop
```go
for _, file := range files {
    if file.IsDir() {
        continue // Skip directories
    }
    // Process file with error handling
}
```

### UUID Generation with Extension
```go
func generateUUIDName(originalName string) string {
    ext := filepath.Ext(originalName)
    newUUID := uuid.New().String()
    return newUUID + ext
}
```

### Safe File Operations
```go
if !config.DryRun {
    if err := os.Rename(oldPath, newPath); err != nil {
        log.Printf("Failed to rename %s: %v", file.Name(), err)
        continue
    }
}
```

## Docker Patterns

### Multi-stage Dockerfile
```dockerfile
FROM golang:1.21-alpine AS builder
# Build stage

FROM alpine:latest
# Runtime stage
```

### Volume Mounting
```yaml
volumes:
  - /host/path:/app/files
```

## Testing Considerations
- Test with various file types and extensions
- Test directory validation
- Test UUID uniqueness
- Test dry-run functionality
- Test error scenarios (permissions, missing files)

## Security Considerations
- Validate input paths to prevent directory traversal
- Handle file permissions appropriately
- Use minimal Docker images
- Don't run containers as root

## Performance Guidelines
- Process files sequentially to avoid race conditions
- Use buffered I/O for large directories
- Implement progress reporting for large operations

When generating code for this project, prioritize safety, error handling, and user experience. Always implement dry-run functionality for destructive operations.
